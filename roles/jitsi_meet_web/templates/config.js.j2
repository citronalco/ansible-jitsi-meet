// {{ ansible_managed }}

// get default config
<!--#include file="config.default.js" -->

// override default example domain names
config.hosts.domain = '{{ inventory_hostname }}';
config.hosts.anonymousdomain = 'guest.{{ inventory_hostname }}';
config.hosts.muc = 'conference.{{ inventory_hostname }}';
config.bosh = 'https://{{ inventory_hostname }}/http-bind';
config.p2p.stunServers = [
    //{ urls: 'stun:meet-jit-si-turnrelay.jitsi.net:443' },
    { urls: 'stun:{{ inventory_hostname }}:3478' },
    { urls: 'stun:{{ inventory_hostname }}:5349' }
];

// to be able to multiplex Jitsi Meet and Coturn on port 443 (variable turns_hostname defined), we have to use bosh instead of websockets
// but even without multiplexing some more changes are required to get websockets working
// see https://tutorials.celogeek.com/books/jitsi-meet-on-arch-linux/page/activate-websocket
//config.websocket = 'wss://{{ inventory_hostname }}/xmpp-websocket';
config.preferBosh = true;

let configDefault = JSON.parse(JSON.stringify(config));
config = {}

// get custom config
<!--#include file="config.local.js" -->

// merge configs
config = Object.assign({}, configDefault, config);
